

/*
 * Filename : sp_common.c
 *
 * Author: Autogenerated by H-DA RTE Generator, (c) Prof. Fromm
 */

#include "project.h"
#include "global.h"
#include "rte.h"
#include "rte_types.h"
#include "sp_common.h"



/* USER CODE START SP_COMMON_INCLUDE */

/* USER CODE END SP_COMMON_INCLUDE */

#include "sc_adc.h"
#include "sc_adc_type.h"
#include "sc_speed.h"
#include "sc_speed_type.h"
#include "sc_pwm.h"
#include "sc_pwm_type.h"
#include "sc_gpio.h"
#include "sc_gpio_type.h"



/* signal configuration */
/*
* description: Joystick x,y for controlling the car manually
* indriver: default
* name: so_joystick
* onDataError: 0
* onDataUpdate: ev_joystick_onData
* outdriver: 0
* resource: None
* shortname: joystick
* signalclass: sc_adc
* signalpool: sp_common
*/


/* The following array contains the receiving tasks for onUpdate signal events */
const TaskTypeArray so_joystick_updTasks = { tsk_control };
 

static const SC_ADC_cfg_t SO_JOYSTICK_cfg = 
{
   /* indriver           */  SC_ADC_driverIn,
   /* outdriver          */  0,

   /* onUpdate           */  ev_joystick_onData,
   /* onError            */  0,
   /* taskCount onUpdate */  1,
   /* task list onUpdate */  &so_joystick_updTasks,
   /* taskCount onError  */  0,
   /* task list onError  */  NULL,

   /* resource active    */  FALSE,
   /* resource           */  NULL,
   
}; /* configuration so_joystick */


/* signal data */

SC_ADC_t SO_JOYSTICK_signal= 
{
   /* init value    */  SC_ADC_INIT_DATA,
   /* status        */  RTE_SIGNALSTATUS_STARTUP,
   /* age           */  0,
   /* cfg           */  &SO_JOYSTICK_cfg,
}; /* data so_joystick */

/* signal configuration */
/*
* description: Target speed defined by the user or the ADAS algorithm
* indriver: 0
* name: so_speed
* onDataError: 0
* onDataUpdate: ev_speed_onData
* outdriver: 0
* resource: None
* shortname: speed
* signalclass: sc_speed
* signalpool: sp_common
*/


/* The following array contains the receiving tasks for onUpdate signal events */
const TaskTypeArray so_speed_updTasks = { tsk_io };
 

static const SC_SPEED_cfg_t SO_SPEED_cfg = 
{
   /* indriver           */  0,
   /* outdriver          */  0,

   /* onUpdate           */  ev_speed_onData,
   /* onError            */  0,
   /* taskCount onUpdate */  1,
   /* task list onUpdate */  &so_speed_updTasks,
   /* taskCount onError  */  0,
   /* task list onError  */  NULL,

   /* resource active    */  FALSE,
   /* resource           */  NULL,
   
}; /* configuration so_speed */


/* signal data */

SC_SPEED_t SO_SPEED_signal= 
{
   /* init value    */  SC_SPEED_INIT_DATA,
   /* status        */  RTE_SIGNALSTATUS_STARTUP,
   /* age           */  0,
   /* cfg           */  &SO_SPEED_cfg,
}; /* data so_speed */

/* signal configuration */
/*
* description: Engine value to be written to the RGB LED
* indriver: 0
* name: so_engine
* onDataError: 0
* onDataUpdate: 0
* outdriver: default
* resource: None
* shortname: engine
* signalclass: sc_pwm
* signalpool: sp_common
*/

 

static const SC_PWM_cfg_t SO_ENGINE_cfg = 
{
   /* indriver           */  0,
   /* outdriver          */  SC_PWM_driverOut,

   /* onUpdate           */  0,
   /* onError            */  0,
   /* taskCount onUpdate */  0,
   /* task list onUpdate */  NULL,
   /* taskCount onError  */  0,
   /* task list onError  */  NULL,

   /* resource active    */  FALSE,
   /* resource           */  NULL,
   
}; /* configuration so_engine */


/* signal data */

SC_PWM_t SO_ENGINE_signal= 
{
   /* init value    */  SC_PWM_INIT_DATA,
   /* status        */  RTE_SIGNALSTATUS_STARTUP,
   /* age           */  0,
   /* cfg           */  &SO_ENGINE_cfg,
}; /* data so_engine */

/* signal configuration */
/*
* description: Brakelight signal sent to the red LED
* indriver: 0
* name: so_brakelight
* onDataError: 0
* onDataUpdate: 0
* outdriver: default
* resource: None
* shortname: brakelight
* signalclass: sc_gpio
* signalpool: sp_common
*/

 

static const SC_GPIO_cfg_t SO_BRAKELIGHT_cfg = 
{
   /* indriver           */  0,
   /* outdriver          */  SC_GPIO_driverOut,

   /* onUpdate           */  0,
   /* onError            */  0,
   /* taskCount onUpdate */  0,
   /* task list onUpdate */  NULL,
   /* taskCount onError  */  0,
   /* task list onError  */  NULL,

   /* resource active    */  FALSE,
   /* resource           */  NULL,
   
}; /* configuration so_brakelight */


/* signal data */

SC_GPIO_t SO_BRAKELIGHT_signal= 
{
   /* init value    */  SC_GPIO_INIT_DATA,
   /* status        */  RTE_SIGNALSTATUS_STARTUP,
   /* age           */  0,
   /* cfg           */  &SO_BRAKELIGHT_cfg,
}; /* data so_brakelight */



void RTE_timertick_sp_common_tick(uint32_t tick){
   RTE_SC_ADC_incAge( &SO_JOYSTICK_signal, tick); 
   RTE_SC_SPEED_incAge( &SO_SPEED_signal, tick); 
   RTE_SC_PWM_incAge( &SO_ENGINE_signal, tick); 
   RTE_SC_GPIO_incAge( &SO_BRAKELIGHT_signal, tick); 
   
}


